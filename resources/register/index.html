



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>Registering Resource - Brainlife Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#background" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Brainlife Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Brainlife Documentation
              </span>
              <span class="md-header-nav__topic">
                Registering Resource
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Brainlife Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      End Users
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        End Users
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/project/" title="Project" class="md-nav__link">
      Project
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      App Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        App Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/helloworld/" title="Hello World" class="md-nav__link">
      Hello World
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/register/" title="Register App" class="md-nav__link">
      Register App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/container/" title="Containerizing App" class="md-nav__link">
      Containerizing App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/versioning/" title="Versioning Tips" class="md-nav__link">
      Versioning Tips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/customhooks/" title="Custom Hooks" class="md-nav__link">
      Custom Hooks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Resource Provider
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Resource Provider
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Registering Resource
      </label>
    
    <a href="./" title="Registering Resource" class="md-nav__link md-nav__link--active">
      Registering Resource
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" title="Background" class="md-nav__link">
    Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registering-resources" title="Registering Resources" class="md-nav__link">
    Registering Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-resources" title="Configuring Resources" class="md-nav__link">
    Configuring Resources
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abcd-default-hooks" title="ABCD Default Hooks" class="md-nav__link">
    ABCD Default Hooks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-pbs-cluster" title="For PBS cluster" class="md-nav__link">
    For PBS cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-slurm-cluster" title="For Slurm cluster" class="md-nav__link">
    For Slurm cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-direct-execution-no-batch-submission-manager" title="For direct execution - no batch submission manager" class="md-nav__link">
    For direct execution - no batch submission manager
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-binaries" title="Common Binaries" class="md-nav__link">
    Common Binaries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-apps" title="Enabling Apps" class="md-nav__link">
    Enabling Apps
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Data Publisher
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Data Publisher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../todo/" title="Todo" class="md-nav__link">
      Todo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Learners
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Learners
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../todo/" title="Todo" class="md-nav__link">
      Todo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" title="Background" class="md-nav__link">
    Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registering-resources" title="Registering Resources" class="md-nav__link">
    Registering Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-resources" title="Configuring Resources" class="md-nav__link">
    Configuring Resources
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abcd-default-hooks" title="ABCD Default Hooks" class="md-nav__link">
    ABCD Default Hooks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-pbs-cluster" title="For PBS cluster" class="md-nav__link">
    For PBS cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-slurm-cluster" title="For Slurm cluster" class="md-nav__link">
    For Slurm cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-direct-execution-no-batch-submission-manager" title="For direct execution - no batch submission manager" class="md-nav__link">
    For direct execution - no batch submission manager
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-binaries" title="Common Binaries" class="md-nav__link">
    Common Binaries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-apps" title="Enabling Apps" class="md-nav__link">
    Enabling Apps
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Registering Resource</h1>
                
                <h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<p>Brainlife provides a mechanism to make a computing resource, such as a Cloud compute system or a high-performance computing cluster, available to specific user, projects or user defined groups. By default, shared compute resources are available to all users where most of Brainlife apps are enabled. </p>
<p>As Brainlife's default resources are available by all users, often users must wait on the queue for requested tasks to get executed. You can register your own compute resources for the following use cases.</p>
<ol>
<li>You have access to your own HPC resource, and you'd like to use it to run Brainlife apps, for better performance, or better access control.</li>
<li>You are an app developer and you'd like to use your own resource to troubleshoot your apps on your own resource, for easier debugging.</li>
<li>You are an app developer and your app can only run on specialized resources (like Hadoop, Spark, etc..) that Brainlife's shared resources do not provide.</li>
</ol>
<p>Currently, only Brainlife admin can share personal resources with other members. If you wish to share your resources, please contact <a href="mailto:brlife@iu.edu">Brainlife Admin</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Resource owner decides which apps are allowed to run on their resource. If you register a resource and enable apps on it, only you can run those apps on that resource. If you are publishing your app, and you want all users to be able to execute your app, please contact <a href="mailto:brlife@iu.edu">Brainlife Admin</a> to enable your app on Brainlife default resources.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Although we do our best to limit access to your dataset on shared resources, we recommend registering your own resource for added security
especially if you are planning to process sensitive data. We currently do not allow any datasets with PHI (protected health information).</p>
</div>
<h2 id="registering-resources">Registering Resources<a class="headerlink" href="#registering-resources" title="Permanent link">&para;</a></h2>
<p>To register your resource, go to <a href="https://brainlife.io/amaretti/#!/resources">Brainlife Settings</a> page, and Under "HPC Systems" click "Add New Account". A resource entry form should appear. Please populate the following fields.</p>
<ul>
<li><em>Name</em> Enter the name of rhe resource</li>
<li><em>Hostname</em> The hostname of your compute resource (usually a login/submit host)</li>
<li><em>Username</em> Username used to ssh to this resource</li>
<li><em>Workdir</em> Directory used to stage and store generated datasets by apps. <em>You should not share the same directory with other resources</em>. Please make sure that the specified directory exits (mkdir if not).</li>
<li>SSH Public Key: Copy the content of this key to your resource's ~/.ssh/authorized_keys. Please read <a href="https://www.ssh.com/ssh/authorized_keys/">authorized_keys</a> for more detail.</li>
</ul>
<p>You can leave the rest of the fields empty for now.</p>
<p>Click OK. Once you are finished with copying ssh key and make sure the workdir exists, click "Test" button to see if Brainlife can access your resource. You should see a green checkbox if everything is good.</p>
<h2 id="configuring-resources">Configuring Resources<a class="headerlink" href="#configuring-resources" title="Permanent link">&para;</a></h2>
<p>Once you register your resource, you will need to perform a few things to prepare your resource so that Brainlife can successfully execute Brainlife apps.</p>
<h3 id="abcd-default-hooks">ABCD Default Hooks<a class="headerlink" href="#abcd-default-hooks" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/brain-life/abcd-spec">ABCD Hooks</a> are used to start, stop and monitor apps on remote resources. Some app provides its own hooks, but many of them relies on default hooks that are installed on each resource. As a resource provider, you need to provide these default hooks and make them available by setting <code>$PATH</code>. If you are not sure how to write these scripts, you can install and use Brainlife's default ABCD hooks by doing following.</p>
<div class="codehilite"><pre><span></span>cd ~
git clone https://github.com/brain-life/abcd-spec
</pre></div>


<p>Then, add one of following to your ~/.bashrc</p>
<h4 id="for-pbs-cluster">For PBS cluster<a class="headerlink" href="#for-pbs-cluster" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>export PATH=~/abcd-spec/hooks/pbs:$PATH
</pre></div>


<h4 id="for-slurm-cluster">For Slurm cluster<a class="headerlink" href="#for-slurm-cluster" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>export PATH=~/abcd-spec/hooks/slurm:$PATH
</pre></div>


<h4 id="for-direct-execution-no-batch-submission-manager">For direct execution - no batch submission manager<a class="headerlink" href="#for-direct-execution-no-batch-submission-manager" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>export PATH=~/abcd-spec/hooks/direct:$PATH
</pre></div>


<h3 id="common-binaries">Common Binaries<a class="headerlink" href="#common-binaries" title="Permanent link">&para;</a></h3>
<p>Brainlife expects certain binaries to be installed on all resources. Please make sure following commands are installed.</p>
<ul>
<li>jq (command line json parser commonly used by Brainlife apps to parse config.json)</li>
<li>git (used to clone / update apps installed)</li>
<li>singularity (user level container execution engine)</li>
</ul>
<p>For IU HPC resource, please feel free to use following ~/bin directory which contains jq</p>
<div class="codehilite"><pre><span></span>$ ~/.bashrc
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/N/u/brlife/Carbonate/bin
</pre></div>


<p>For singularity, you can either install it on the system, or for most HPC systems you can simply add following in your <code>~/.modules</code> file.</p>
<div class="codehilite"><pre><span></span><span class="k">module</span> <span class="n">load</span> <span class="n">singularity</span>
</pre></div>


<p>By default, singularity uses user's home directory to cache docker images (and /tmp to create a merged container image to run). If you have limited amount of home directory space, you should override these directories by adding the following in your .bashrc</p>
<div class="codehilite"><pre><span></span>export SINGULARITY_CACHEDIR=/N/dc2/scratch/&lt;username&gt;/singularity-cachedir
</pre></div>


<blockquote>
<p>Please replace <username> with your username, and make sure specified directories exists.</p>
</blockquote>
<h2 id="enabling-apps">Enabling Apps<a class="headerlink" href="#enabling-apps" title="Permanent link">&para;</a></h2>
<p>Once you have registered and tested your resource, you can now enable apps to run on your resource.</p>
<p>Go back to the Brainlife's <a href="https://brainlife.io/amaretti/#!/resources">resource settings page</a>, and click the resource you have created. Under the services section, enter the git org/repo name (such as like <code>brain-life/app-life</code>) for the app that you'd like to enable, and the score for each service. The higher the score is, the more likely the resource will be chosen to run your app (if there are multiple resources available). Brainlife gives higher score for resources that you own (not shared ones), you should leave it the default of 10 unless it's competing with other resource that you have access to. Click OK.</p>
<p>You can see which resource an app is configured to run, and which resource will be chosen when you submit it under App detail / Computing Resources section on Brainlife. <a href="https://brainlife.io/app/58c56cf7e13a50849b258800">example</a></p>
                
                  
                
              
              
                
                  


  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "None";
      this.page.identifier =
        "None";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//brainlife.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../apps/customhooks/" title="Custom Hooks" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Custom Hooks
              </span>
            </div>
          </a>
        
        
          <a href="../../todo/" title="Todo" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Todo
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>